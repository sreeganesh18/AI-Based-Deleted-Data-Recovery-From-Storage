---
phase: 05-user-interface-integration
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: [ui/app.py, ui/state.py, ui/components/logger.py, ui/components/hex_viewer.py, ui/views/config.py]
autonomous: true
requirements: [UI-01, UI-04]
---

<objective>
Setup the core structure for the Multi-page Streamlit application, initialize session state management, and implement the initial configuration page for recovery setup.

Purpose: Provides the foundation for all subsequent UI features.
Output: Working multi-page app with navigation and configuration controls.
</objective>

<execution_context>
@C:/Users/devid/.gemini/get-shit-done/workflows/execute-plan.md
@C:/Users/devid/.gemini/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-CONTEXT.md
@.planning/phases/05-user-interface-integration/05-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Core App Structure & State Management</name>
  <files>ui/app.py, ui/state.py</files>
  <action>
    1. Create `ui/state.py` to manage `st.session_state`. Define keys for: `disk_image_path`, `clf_checkpoint`, `ae_checkpoint`, `recovery_session` (active/inactive), `carved_fragments` (list), `reconstructed_files` (list), and `logs` (list).
    2. Create `ui/app.py` as the entry point.
    3. Use `st.navigation` in `ui/app.py` to define four pages: "Configuration" (ui/views/config.py), "Scanning & Carving" (ui/views/scanning.py), "Review & Reassemble" (ui/views/review.py), and "Export Results" (ui/views/export.py).
    4. Set page title and favicon.
    5. Install `streamlit-image-comparison` via uv pip.
  </action>
  <verify>
    <automated>python -m streamlit run ui/app.py --server.headless true</automated>
    <manual>Run Streamlit and verify navigation menu exists and page switching works.</manual>
    <sampling_rate>run after this task commits</sampling_rate>
  </verify>
  <done>Multi-page navigation is functional and session state is initialized.</done>
</task>

<task type="auto">
  <name>Task 2: UI Components (Logger & Hex Viewer)</name>
  <files>ui/components/logger.py, ui/components/hex_viewer.py</files>
  <action>
    1. Implement `ui/components/logger.py`: A `StreamlitLogHandler` class that appends records to `st.session_state.logs`.
    2. Implement `ui/components/hex_viewer.py`: A function `render_hex_viewer(data)` that uses `st.html` to display a monospaced hex dump (offset, hex, ascii) with clean styling as per 05-RESEARCH.md.
  </action>
  <verify>
    <automated>MISSING â€” Wave 1 Task 3 will test these components visually</automated>
    <manual>Check code for correct `st.html` usage and state integration.</manual>
    <sampling_rate>run after this task commits</sampling_rate>
  </verify>
  <done>Reusable components for logging and hex inspection are implemented.</done>
</task>

<task type="auto">
  <name>Task 3: Configuration Page Implementation</name>
  <files>ui/views/config.py</files>
  <action>
    1. Implement `ui/views/config.py` with the following:
       - Header: "Recovery Setup".
       - File pickers (using `st.text_input` for paths or `st.file_uploader` if applicable, but text_input preferred for raw disk images) for Disk Image Path.
       - Select boxes for Model Checkpoints (scan `models/checkpoints/` for .pth files).
       - "Initialize Session" button that validates paths and sets `st.session_state.recovery_session = True`.
       - Display a test hex-dump using `ui/components/hex_viewer.py` if a disk image is selected to verify access.
  </action>
  <verify>
    <automated>python -m streamlit run ui/app.py --server.headless true</automated>
    <manual>Open UI, navigate to Configuration, select files, and click Initialize. Verify state changes.</manual>
    <sampling_rate>run after this task commits</sampling_rate>
  </verify>
  <done>User can configure the recovery session and verify data access.</done>
</task>

</tasks>

<verification>
Check that the Streamlit app starts, navigation works between all pages (even if empty), and the Configuration page correctly updates session state with valid paths.
</verification>

<success_criteria>
- App entry point `ui/app.py` uses `st.navigation`.
- `ui/state.py` initializes all required session keys.
- Configuration page allows path input and checkpoint selection.
- Hex viewer correctly formats binary data.
</success_criteria>

<output>
After completion, create `.planning/phases/05-user-interface-integration/05-01-SUMMARY.md`
</output>
