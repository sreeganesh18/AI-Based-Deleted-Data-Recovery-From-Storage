---
phase: 03-carving-denoising
plan: 03
type: execute
wave: 3
depends_on: [03-02-PLAN.md]
files_modified: [utils/reporting.py, tests/test_integrated_pipeline.py]
autonomous: true
requirements: [PH3-06]
must_haves:
  truths:
    - "Carving summary reports total fragments and their classification breakdown."
    - "Integrated pipeline supports E2E validation on sample images."
    - "Visual comparison data is generated for evaluation."
  artifacts:
    - path: "utils/reporting.py"
      provides: "Reporting utilities for carving summaries"
    - path: "tests/test_integrated_pipeline.py"
      provides: "End-to-End recovery validation test"
---

<objective>
Validate the integrated carving and denoising pipeline with comprehensive reporting and E2E testing.
Purpose: Ensure the system operates correctly from raw storage scan to identified and denoised fragments, providing useful feedback to the user.
Output: Reporting utilities and a verified integrated pipeline.
</objective>

<execution_context>
@C:/Users/devid/.gemini/get-shit-done/workflows/execute-plan.md
@C:/Users/devid/.gemini/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/phases/03-CONTEXT.md
@storage_scan/scanner.py
@carving/hybrid.py
@reconstruction/denoise.py
</context>

<tasks>

<task type="auto">
  <name>Task 1: Implement Reporting Utilities</name>
  <files>utils/reporting.py</files>
  <action>
    - Create `utils/reporting.py` with `generate_carving_summary`.
    - It should take the results from `HybridCarver.scan_disk` and produce a summary:
      - Total fragments scanned.
      - Identified as JPEG (Signature vs AI).
      - Identified as PDF (Signature vs AI).
      - Unidentified / Other.
    - Implement a utility for `get_visual_comparison` that prepares (original, denoised) data pairs for later UI use.
  </action>
  <verify>
    <automated>python utils/reporting.py --test</automated>
  </verify>
  <done>Reporting utilities provide comprehensive summaries and data for visual comparison.</done>
</task>

<task type="auto">
  <name>Task 2: End-to-End Pipeline Validation</name>
  <files>tests/test_integrated_pipeline.py</files>
  <action>
    - Create `tests/test_integrated_pipeline.py`.
    - Create a small dummy disk image (1 MB) containing known JPEG/PDF patterns.
    - Use `DiskScanner` to scan it.
    - Use `HybridCarver` to identify fragments.
    - Use `DenoisingPipeline` to clean the identified fragments.
    - Generate a final summary using `utils/reporting.py`.
    - Assert that identified fragments match the expected types.
  </action>
  <verify>
    <automated>pytest tests/test_integrated_pipeline.py</automated>
  </verify>
  <done>Integrated pipeline correctly handles raw storage to denoised identification in an E2E scenario.</done>
</task>

</tasks>

<verification>
Check `tests/test_integrated_pipeline.py` results.
Verify that the carving summary matches the expected distribution of fragments.
</verification>

<success_criteria>
- Comprehensive summary generated after scanning.
- E2E test passes on a dummy image.
- Denoised outputs are correctly stored and linked to identified fragments.
</success_criteria>

<output>
After completion, create `.planning/phases/03-carving-denoising/03-03-SUMMARY.md`
</output>
