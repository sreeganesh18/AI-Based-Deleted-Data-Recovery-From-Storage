---
phase: 06-testing-validation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: [tests/test_scanner.py, tests/test_carver.py, tests/test_models.py, tests/test_reconstruction.py, tests/test_utils.py, tests/test_integrated_pipeline.py, tests/test_e2e_recovery.py]
autonomous: true
requirements: [TEST-01, TEST-02]
must_haves:
  truths:
    - "All core modules have >80% unit test coverage."
    - "Integration tests confirm data flow between scanner, carver, and models."
    - "E2E tests successfully recover files from a fragmented simulated disk image."
  artifacts:
    - path: "tests/test_integrated_pipeline.py"
      provides: "Integration testing for the full recovery chain"
---

<objective>
Implement comprehensive unit and integration testing for all core recovery modules to ensure reliability and robustness against various corruption scenarios.
</objective>

<tasks>
<task type="auto">
  <name>Task 1: Comprehensive Unit Testing</name>
  <files>tests/test_scanner.py, tests/test_carver.py, tests/test_models.py, tests/test_reconstruction.py, tests/test_utils.py</files>
  <action>
    Create or update unit tests for:
    - storage_scan: Reading sectors, boundary handling, entropy calculation.
    - carving: NTFS/FAT32 signature matching, HybridCarver logic.
    - models: Classifier inference, Autoencoder denoising outputs.
    - reconstruction: Fragment grouping, JPEG/PDF repair logic.
    - utils: Metadata extraction and validation functions.
    Use pytest fixtures for mock data.
  </action>
  <verify>pytest tests/test_scanner.py tests/test_carver.py tests/test_models.py tests/test_reconstruction.py tests/test_utils.py</verify>
  <done>All unit tests pass with no regressions.</done>
</task>

<task type="auto">
  <name>Task 2: Integration & E2E Testing</name>
  <files>tests/test_integrated_pipeline.py, tests/test_e2e_recovery.py</files>
  <action>
    Develop integration tests that:
    - Simulate disk images with known fragmentation patterns.
    - Verify that the scanner correctly passes fragments to the carver.
    - Ensure the reassembly engine correctly handles out-of-order fragments.
    - E2E: Run the full pipeline (Scan -> Carve -> Denoise -> Reconstruct) and verify MD5 of recovered vs original files.
  </action>
  <verify>pytest tests/test_integrated_pipeline.py tests/test_e2e_recovery.py</verify>
  <done>Pipeline successfully recovers 90%+ of fragmented files in simulated scenarios.</done>
</task>
</tasks>
